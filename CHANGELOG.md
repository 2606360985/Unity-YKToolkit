# Unity Pro Toolbox 更新日志

## [v1.7] - 2025-12-26

### 🎉 新增功能

#### 1. **模块折叠系统**
- ✅ 所有功能模块默认折叠状态，节省界面空间
- ✅ 点击模块标题栏左侧的折叠按钮可展开/折叠
- ✅ 折叠状态自动保存，下次打开窗口时恢复
- ✅ 拖拽时自动禁用折叠按钮，避免冲突

#### 2. **拖拽排序功能**
- ✅ 支持通过拖拽重新排列功能模块顺序
- ✅ 拖拽手柄图标（网格图标或三条横线）位于模块标题栏中间
- ✅ 拖拽时显示视觉反馈：
  - 被拖拽的模块高亮显示
  - 目标位置显示蓝色插入指示线
- ✅ 模块顺序自动保存到 EditorPrefs，下次打开时恢复
- ✅ 拖拽后标题序号自动更新（如：拖拽后 "1. 智能批量材质生成" 变为 "2. 智能批量材质生成"）

### 🔧 改进优化

#### 1. **图标加载系统**
- ✅ 添加安全的图标加载方法 `GetIconSafely()`，避免警告信息
- ✅ 支持多个备选图标名称，提高兼容性
- ✅ 图标加载失败时自动绘制备用拖拽手柄（三条横线）
- ✅ 临时禁用警告日志，避免控制台污染

#### 2. **界面优化**
- ✅ 调整模块间距，使界面更紧凑（用户可自定义）
- ✅ 优化标题栏布局和字体大小
- ✅ 改进拖拽手柄的视觉反馈（悬停时高亮）

#### 3. **事件处理优化**
- ✅ 改进拖拽事件处理逻辑，确保拖拽功能稳定可靠
- ✅ 优化事件处理顺序，避免折叠按钮和拖拽功能冲突
- ✅ 添加鼠标移出窗口时的状态重置

### 🐛 问题修复

- ✅ 修复拖拽功能无法正常工作的问题
- ✅ 修复图标加载时的警告信息
- ✅ 修复拖拽后标题序号不更新的问题
- ✅ 修复模块间距过大导致界面浪费空间的问题

### 📝 技术细节

#### 代码结构改进
- 重构模块系统，使用 `ModuleInfo` 类统一管理模块信息
- 将模块绘制逻辑拆分为独立的 `DrawModule1()` 到 `DrawModule12()` 方法
- 添加 `InitializeModules()` 方法统一初始化模块系统
- 添加 `HandleGlobalDragEvents()` 统一处理拖拽结束事件

#### 数据持久化
- 模块顺序保存到 `EditorPrefs`（键名：`UnityProToolbox_ModuleOrder`）
- 每个模块的折叠状态单独保存（键名：`UnityProToolbox_ModuleExpanded_{模块ID}`）

---

## [v1.6] - 之前版本

### 核心功能
- 智能批量材质生成
- 物理对齐
- 批量重命名
- 资产替换
- 布局助手
- 随机变换
- 系统清理
- 快速对齐与等距分布
- 批量静态设置
- 查找重复物体
- 烘焙精度双档切换（增强版）
- 快速创建助手

---

## 使用说明

### 折叠/展开模块
点击模块标题栏左侧的折叠按钮（三角形图标）

### 拖拽排序模块
1. 将鼠标移到模块标题栏中间的拖拽手柄上（网格图标或三条横线）
2. 按住鼠标左键并拖动
3. 拖动到目标位置后释放鼠标
4. 模块会自动移动到新位置，标题序号也会自动更新

### 自定义间距
如需调整模块间距，可修改 `DrawDraggableModule()` 方法中的 `EditorGUILayout.Space()` 参数值

---

**开发者**: RepinSKY  
**版本**: v1.7  
**最后更新**: 2025-12-26

